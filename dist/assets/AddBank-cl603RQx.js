import{r as e,j as a}from"./react-vendor-0Am1niUb.js";import{u as t,s,S as n}from"./index-BonT0QVc.js";import"./supabase-BsxaddrC.js";import"./vendor-DtN75V_I.js";const r=({onNavigate:r,showToast:l})=>{const{withLoading:i}=t(),[o,c]=e.useState(""),[d,x]=e.useState(""),[p,m]=e.useState(""),[u,h]=e.useState(!1),[b,g]=e.useState(null),[f,j]=e.useState("create"),[v,N]=e.useState(!1),[y,w]=e.useState(null),k={"Banco BAI":"0040","Banco BFA":"0006","Banco BIC":"0051","Banco Atlântico":"0055","Banco Sol":"0044","Banco BNI":"0009"};e.useEffect(()=>{if(y){const e=setTimeout(()=>w(null),3e3);return()=>clearTimeout(e)}},[y]),e.useEffect(()=>{B()},[]);const B=async()=>{h(!0);try{const{data:e}=await s.rpc("get_my_bank_accounts");e&&e.length>0&&(g(e[0]),j("view"))}catch(e){}finally{h(!1)}};return a.jsxs("div",{className:"bg-[#F4F7F6] min-h-screen font-display text-gray-900 pb-20 antialiased selection:bg-[#00C853]/10",children:[a.jsxs("div",{className:"bg-gradient-to-br from-[#0F1111] to-[#1A1C1C] pt-12 pb-24 px-6 rounded-b-[48px] shadow-2xl relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-[#00C853]/10 blur-[100px] rounded-full -translate-y-1/2 translate-x-1/2 overflow-hidden pointer-events-none"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-[#00C853]/5 blur-[80px] rounded-full translate-y-1/2 -translate-x-1/2 overflow-hidden pointer-events-none"}),a.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[a.jsx("button",{onClick:()=>r("profile"),className:"size-11 flex items-center justify-center rounded-2xl bg-white/10 backdrop-blur-md text-white border border-white/10 active:scale-90 transition-all",children:a.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"arrow_back"})}),a.jsx("h1",{className:"text-white text-[18px] font-black tracking-tight",children:"view"===f?"Dados Bancários":"edit"===f?"Editar Conta":"Nova Conta"}),a.jsx("div",{className:"size-11"})]})]}),a.jsx("main",{className:"px-6 -mt-16 relative z-10 space-y-8",children:"view"===f?a.jsxs("div",{className:"space-y-8 animate-in fade-in zoom-in-95 duration-500",children:[a.jsxs("div",{className:"bg-white rounded-[36px] p-8 shadow-premium border border-white/50 relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-[0.03] pointer-events-none",children:a.jsx("span",{className:"material-symbols-outlined text-[120px]",children:"verified"})}),a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"size-16 bg-[#EEFFF5] rounded-[24px] flex items-center justify-center mx-auto mb-4 shadow-inner",children:a.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[32px]",children:"verified_user"})}),a.jsx("h2",{className:"text-[20px] font-black text-gray-900 tracking-tight leading-none",children:"Conta Vinculada"}),a.jsx("p",{className:"text-gray-400 text-[14px] font-medium mt-1",children:"Seus ganhos serão enviados para aqui."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-2xl p-5 border border-gray-100/50",children:[a.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest block mb-2",children:"Banco"}),a.jsx("p",{className:"text-[15px] font-black text-gray-900",children:b?.nome_banco})]}),a.jsxs("div",{className:"bg-gray-50 rounded-2xl p-5 border border-gray-100/50",children:[a.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest block mb-2",children:"Titular da Conta"}),a.jsx("p",{className:"text-[15px] font-black text-gray-900",children:b?.nome_completo})]}),a.jsxs("div",{className:"bg-gray-50 rounded-2xl p-5 border border-gray-100/50",children:[a.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest block mb-2",children:"IBAN Destino"}),a.jsx("p",{className:"text-[14px] font-black text-gray-900 font-mono tracking-tighter break-all",children:b?.iban})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4 px-2",children:[a.jsx("button",{onClick:()=>{b&&(c(b.nome_banco),x(b.nome_completo),m(b.iban),j("edit"))},className:"w-full h-[60px] bg-gray-900 text-white font-black rounded-[24px] text-[15px] uppercase tracking-widest shadow-xl active:scale-[0.97] transition-all",children:"Editar Dados"}),a.jsx("button",{onClick:()=>{N(!0)},className:"w-full h-[54px] text-red-500 font-bold text-[13px] uppercase tracking-widest hover:bg-red-50 rounded-[20px] transition-all",children:"Remover Conta"})]})]}):a.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[a.jsxs("div",{className:"bg-white rounded-[36px] p-8 shadow-premium border border-white/50 space-y-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h2",{className:"text-[20px] font-black text-gray-900 tracking-tight leading-none",children:"Dados Bancários"}),a.jsx("p",{className:"text-gray-400 text-[14px] font-medium mt-1",children:"Vincule uma conta para receber seus lucros."})]}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-1",children:"Selecione o Banco"}),a.jsxs("div",{className:"group bg-gray-50 rounded-[24px] h-[64px] flex items-center px-5 gap-4 border-2 border-transparent focus-within:border-[#00C853] transition-all relative",children:[a.jsx("div",{className:"size-10 rounded-2xl bg-white flex items-center justify-center text-[#00C853] shadow-sm",children:a.jsx("span",{className:"material-symbols-outlined",children:"account_balance"})}),a.jsxs("select",{value:o,onChange:e=>c(e.target.value),className:"bg-transparent flex-1 h-full outline-none text-gray-900 font-black appearance-none cursor-pointer text-[15px] pr-10",children:[a.jsx("option",{value:"",children:"Escolha seu banco..."}),a.jsx("option",{value:"Banco BAI",children:"Banco BAI"}),a.jsx("option",{value:"Banco BFA",children:"Banco BFA"}),a.jsx("option",{value:"Banco BIC",children:"Banco BIC"}),a.jsx("option",{value:"Banco Atlântico",children:"Banco Atlântico"}),a.jsx("option",{value:"Banco Sol",children:"Banco Sol"}),a.jsx("option",{value:"Banco BNI",children:"Banco BNI"})]}),a.jsx("span",{className:"material-symbols-outlined text-gray-300 absolute right-5 pointer-events-none",children:"unfold_more"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-1",children:"Nome do Titular"}),a.jsxs("div",{className:"group bg-gray-50 rounded-[24px] h-[64px] flex items-center px-5 gap-4 border-2 border-transparent focus-within:border-[#00C853] transition-all",children:[a.jsx("div",{className:"size-10 rounded-2xl bg-white flex items-center justify-center text-[#00C853] shadow-sm",children:a.jsx("span",{className:"material-symbols-outlined",children:"person"})}),a.jsx("input",{value:d,onChange:e=>x(e.target.value),className:"bg-transparent flex-1 h-full outline-none text-gray-900 font-black placeholder:text-gray-200 text-[15px]",placeholder:"Nome completo",type:"text"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-1",children:"IBAN (21 Dígitos)"}),a.jsxs("div",{className:"group bg-gray-50 rounded-[24px] h-[64px] flex items-center px-5 gap-4 border-2 border-transparent focus-within:border-[#00C853] transition-all",children:[a.jsx("div",{className:"size-10 rounded-2xl bg-white flex items-center justify-center text-[#00C853] shadow-sm",children:a.jsx("span",{className:"material-symbols-outlined",children:"pin"})}),a.jsx("input",{value:p,onChange:e=>{let a=e.target.value.replace(/\D/g,"");m(a)},maxLength:21,className:"bg-transparent flex-1 h-full outline-none text-gray-900 font-mono font-black placeholder:text-gray-200 text-[15px] tracking-tight",placeholder:"0000 0000 0000 0000 0000 0",type:"text"})]})]})]})]}),a.jsxs("div",{className:"pt-4 space-y-4",children:[a.jsx("button",{onClick:async()=>{try{w(null);let e=p.replace(/\D/g,"");if(21!==e.length)return void w("O IBAN deve ter exatamente 21 dígitos.");let a=`AO06${e}`;if(o&&k[o]){const a=k[o];if(e.substring(0,4)!==a)return void w(`Este IBAN não corresponde ao ${o}. Verifique se selecionou o banco correto.`)}await i(async()=>{const{data:{user:e}}=await s.auth.getUser();if(!e)throw new Error("Sessão expirada. Acesse novamente.");const t={p_bank_name:o,p_holder_name:d,p_iban:a},{error:n}=await s.rpc("edit"===f?"update_bank_account":"add_bank_account",t);if(n)throw n;l?.("Bem sucedido","success"),await B(),setTimeout(()=>r("profile"),1200)},"Salvando dados bancários...")}catch(e){e.message&&!e.message.includes("loading")&&w(e.message)}},disabled:u,className:"w-full h-[64px] bg-[#00C853] text-white font-black rounded-[24px] text-[15px] uppercase tracking-widest shadow-[0_16px_32px_-8px_rgba(0,200,83,0.5)] active:scale-[0.97] transition-all flex items-center justify-center",children:u?a.jsx(n,{size:"w-6 h-6",color:"text-white"}):"Salvar Dados"}),"edit"===f&&a.jsx("button",{onClick:()=>j("view"),className:"w-full h-[54px] text-gray-400 font-bold text-[13px] uppercase tracking-widest hover:text-gray-600 transition-all",children:"Cancelar"}),a.jsxs("div",{className:"flex items-center justify-center gap-2 opacity-30 pt-4",children:[a.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"verified_user"}),a.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:"Servidor Bancário Blindado"})]})]})]})}),y&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center pointer-events-none animate-in fade-in duration-200",children:a.jsx("div",{className:"bg-red-500/90 text-white px-6 py-3 rounded-xl max-w-sm mx-4 text-center text-sm font-medium pointer-events-auto",children:y})}),v&&a.jsx("div",{className:"fixed inset-0 z-[9999] bg-white/60 backdrop-blur-md flex items-end sm:items-center justify-center p-4",children:a.jsx("div",{className:"bg-white w-full max-w-sm rounded-[32px] shadow-2xl border border-gray-50 overflow-hidden animate-in fade-in slide-in-from-bottom-8 duration-300",children:a.jsxs("div",{className:"p-8 text-center space-y-6",children:[a.jsx("div",{className:"size-16 bg-red-50 rounded-full flex items-center justify-center mx-auto border border-red-100",children:a.jsx("span",{className:"material-symbols-outlined text-red-500 text-3xl",children:"delete_forever"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-xl font-bold text-[#0F1111]",children:"Apagar Conta?"}),a.jsx("p",{className:"text-[#565959] text-sm",children:"Esta ação não pode ser desfeita. Você precisará vincular novamente para realizar saques."})]}),a.jsxs("div",{className:"flex flex-col gap-3 pt-2",children:[a.jsx("button",{onClick:async()=>{N(!1),h(!0);try{const{error:e}=await s.from("bancos_clientes").delete().eq("user_id",b.user_id);if(e)throw e;l?.("Apagada sucesso!","success"),g(null),c(""),x(""),m(""),j("create")}catch(e){l?.("Erro ao deletar: "+(e.message||"Erro desconhecido"),"error")}finally{h(!1)}},className:"w-full h-[45px] bg-red-500 text-white font-black text-[15px] rounded-2xl shadow-lg shadow-red-500/20 active:scale-95 transition-all",children:"Confirmar Exclusão"}),a.jsx("button",{onClick:()=>N(!1),className:"w-full h-[45px] text-[#565959] font-bold text-[14px] hover:bg-gray-50 rounded-2xl transition-all",children:"Manter Conta"})]})]})})})]})};export{r as default};
