import{r as e,R as a,j as t}from"./react-vendor-C8-TlGsU.js";import{s,S as r}from"./index-BaS3q1EV.js";import"./pdf-utils-DX6aKe5X.js";import"./vendor-D2WcXlqy.js";import"./supabase-DIRwJvxg.js";const i=({onNavigate:i,onLogout:l,profile:o,showToast:n})=>{const[c,d]=e.useState(o),[x,p]=e.useState(null),[m,g]=e.useState({balance:o?.balance||0,total_earnings:0,today_earnings:0});e.useEffect(()=>{o&&(d(o),b());const e=e=>{e.preventDefault(),p(e)};return window.addEventListener("beforeinstallprompt",e),()=>{window.removeEventListener("beforeinstallprompt",e)}},[o]);const u=a.useCallback(async()=>{try{if(x){x.prompt();const{outcome:e}=await x.userChoice;"accepted"===e&&(p(null),n?.("Instalação iniciada!","success"))}else{if(window.matchMedia("(display-mode: standalone)").matches||navigator.standalone)return void n?.("O aplicativo já está instalado e em execução.","success");const e=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;n?.(e?"Para instalar no iOS: Toque em 'Compartilhar' e depois em 'Adicionar à Tela de Início'":"Para instalar no Android: Use o menu do navegador e selecione 'Instalar Aplicativo'.","info")}}catch(e){n?.("Não foi possível abrir o instalador. Tente pelo menu do navegador.","error")}},[x,n]),h=a.useMemo(()=>[{label:"Meus dispositivos",icon:"assignment",page:"purchase-history",color:"bg-green-50 text-[#00C853]"},{label:"Extrato de conta",icon:"account_balance",page:"historico-conta",color:"bg-green-50 text-[#00C853]"},{label:"Equipe",icon:"pie_chart",page:"subordinate-list",color:"bg-green-50 text-[#00C853]"},{label:"Ajuda",icon:"description",page:"tutorials",color:"bg-green-50 text-[#00C853]"},{label:"Resgatar cupons",icon:"auto_awesome",page:"gift-chest",color:"bg-green-50 text-[#00C853]"},{label:"Marketplace",icon:"storefront",page:"investimentos-fundo",color:"bg-green-50 text-[#00C853]"},{label:"Transf. Interna",icon:"sync_alt",page:"p2p-transfer",color:"bg-green-50 text-[#00C853]"},{label:"Alterar senha login",icon:"lock_open",page:"change-password",color:"bg-green-50 text-[#00C853]"},{label:"Definir PIN de retirada",icon:"vibration",page:"withdraw-password",color:"bg-green-50 text-[#00C853]"},{label:"Alterar PIN de retirada",icon:"security",page:"update-withdraw-password",color:"bg-green-50 text-[#00C853]"},{label:"Dados bancários",icon:"account_balance",page:"detalhes-conta",color:"bg-green-50 text-[#00C853]"},{label:"Quem Somos",icon:"corporate_fare",page:"about-bp",color:"bg-green-50 text-[#00C853]"},{label:"Termos e regras",icon:"gavel",page:"info",color:"bg-green-50 text-[#00C853]"}],[u]),b=async()=>{if(c?.id)try{const{data:e}=await s.auth.getUser(),a=e.user?.id;if(!a)return;const[t,r,i,l,o,n]=await Promise.all([s.rpc("get_profile_stats"),s.from("retirada_clientes").select("valor_solicitado").eq("user_id",a).in("estado_da_retirada",["concluido","aprovado","sucedido","processado","pagamento_enviado"]),s.from("depositos_clientes").select("valor_deposito").eq("user_id",a).in("estado_de_pagamento",["sucedido","completo","sucesso","concluido"]),s.from("depositos_usdt").select("amount_kz").eq("user_id",a).in("status",["sucedido","completo","sucesso","concluido"]),s.from("bonus_transacoes").select("valor_recebido").eq("user_id",a),s.rpc("get_my_team")]),c=r.data?.reduce((e,a)=>e+Number(a.valor_solicitado||0),0)||0,d=(i.data?.reduce((e,a)=>e+Number(a.valor_deposito||0),0)||0)+(l.data?.reduce((e,a)=>e+Number(a.amount_kz||0),0)||0),x=o.data?.reduce((e,a)=>e+Number(a.valor_recebido||0),0)||0,p=n.data?.length||0;g({balance:t.data?.balance||0,today_earnings:t.data?.renda_diaria||0,total_withdrawals:c,total_recharge:d,total_rewards:x,total_subordinates:p})}catch(e){}};return c?t.jsxs("div",{className:"bg-white min-h-screen pb-24 font-sans text-[#333]",children:[t.jsx("div",{className:"header-gradient-mixture pt-8 pb-20 px-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"size-14 rounded-full border-2 border-white overflow-hidden bg-white",children:t.jsx("img",{src:c?.avatar_url||"/default_avatar.png",onError:e=>{e.currentTarget.src="/default_avatar.png",e.currentTarget.onerror=null},alt:"Avatar",className:"w-full h-full object-cover"})}),t.jsxs("div",{className:"text-white",children:[t.jsxs("p",{className:"font-bold text-[15px]",children:["+244: ",c.phone||"N/A"]}),t.jsxs("p",{className:"text-[12px] opacity-90",children:["ID: ",c.invite_code||"---"]})]})]}),t.jsx("button",{onClick:l,className:"px-5 py-1.5 bg-white/20 rounded-full text-white text-[13px] font-bold border border-white/30 active:scale-95 transition-all",children:"Sair"})]})}),t.jsx("div",{className:"px-4 -mt-12 relative z-20",children:t.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-2xl border border-gray-100 flex items-center justify-between overflow-hidden",children:[t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("span",{className:"text-gray-400 text-[11px] font-black uppercase tracking-widest",children:"Saldo Disponível"}),t.jsxs("div",{className:"flex items-baseline gap-1.5",children:[t.jsx("span",{className:"text-[28px] font-black text-black",children:(m.balance||0).toLocaleString("pt-AO",{minimumFractionDigits:2})}),t.jsx("span",{className:"text-[14px] font-bold text-gray-400",children:"KZs"})]})]}),t.jsx("button",{onClick:()=>i("p2p-transfer"),className:"bg-[#00C853] text-white size-12 rounded-2xl flex items-center justify-center shadow-lg shadow-[#00C853]/20 active:scale-90 transition-all",children:t.jsx("span",{className:"material-symbols-outlined text-white text-[24px]",children:"wallet"})})]})}),t.jsxs("div",{className:"px-4 mt-6 grid grid-cols-2 gap-4",children:[t.jsxs("button",{onClick:()=>i("deposit"),className:"flex items-center justify-center gap-2 bg-[#00C853] text-white h-[45px] rounded-xl font-bold text-[15px] active:scale-95 transition-all shadow-sm",children:[t.jsx("span",{className:"material-symbols-outlined",children:"payments"}),"Recarregar"]}),t.jsxs("button",{onClick:()=>i("retirada"),className:"flex items-center justify-center gap-2 bg-[#00C853] text-white h-[45px] rounded-xl font-bold text-[15px] active:scale-95 transition-all shadow-sm",children:[t.jsx("span",{className:"material-symbols-outlined",children:"account_balance_wallet"}),"Retirar"]})]}),t.jsx("div",{className:"px-4 mt-6",children:t.jsxs("div",{className:"bg-white p-4 rounded-[24px] shadow-sm border border-gray-100/60",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3 pb-3 border-b border-dashed border-gray-100",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400 text-[9px] uppercase font-bold tracking-wider",children:"Renda de hoje"}),t.jsxs("p",{className:"text-[16px] font-black text-[#00C853] mt-0.5 tracking-tight",children:["+ ",(m.today_earnings||0).toLocaleString("pt-AO",{minimumFractionDigits:2})," Kz"]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("span",{className:"text-gray-400 text-[9px] uppercase font-bold tracking-wider",children:"Total retiradas"}),t.jsxs("div",{className:"flex items-center justify-end gap-1 mt-0.5",children:[t.jsx("span",{className:"material-symbols-outlined text-[15px] text-[#D32F2F]",children:"trending_down"}),t.jsxs("p",{className:"text-[16px] font-black text-[#D32F2F] tracking-tight",children:["- ",(m.total_withdrawals||0).toLocaleString("pt-AO",{minimumFractionDigits:2})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400 text-[9px] uppercase font-bold tracking-wider",children:"Recarga total"}),t.jsxs("p",{className:"text-[15px] font-black text-[#00600f] mt-0.5",children:["+ ",(m.total_recharge||0).toLocaleString("pt-AO",{minimumFractionDigits:2})," Kz"]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("span",{className:"text-gray-400 text-[9px] uppercase font-bold tracking-wider",children:"Total recompensas"}),t.jsxs("p",{className:"text-[15px] font-black text-[#111] mt-0.5",children:[(m.total_rewards||0).toLocaleString("pt-AO",{minimumFractionDigits:2})," Kz"]})]})]})]})}),t.jsx("div",{className:"px-4 mt-6",children:t.jsx("div",{className:"bg-gray-50 border border-gray-100 rounded-2xl p-6 shadow-sm grid grid-cols-4 gap-y-8 gap-x-2",children:h.map(e=>t.jsxs("div",{onClick:()=>e.action?e.action():i(e.page),className:"flex flex-col items-center gap-2 cursor-pointer active:scale-95 transition-all text-center",children:[t.jsx("div",{className:`size-12 rounded-full flex items-center justify-center ${e.color}`,children:t.jsx("span",{className:"material-symbols-outlined text-[24px]",children:e.icon})}),t.jsx("span",{className:"text-[10px] text-gray-500 leading-tight font-medium px-1 capitalize",children:e.label})]},e.label))})}),t.jsx("div",{className:"px-4 mt-6",children:t.jsxs("div",{onClick:()=>i("invite-page"),className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-2xl p-5 border border-orange-100 flex items-center justify-between cursor-pointer active:scale-[0.98] transition-all relative overflow-hidden",children:[t.jsxs("div",{className:"relative z-10",children:[t.jsx("h4",{className:"font-black text-[16px] text-orange-900",children:"Convide para Ganhar Moedas"}),t.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[t.jsx("span",{className:"text-[11px] text-orange-700 font-bold uppercase tracking-wider",children:"Convidar"}),t.jsx("div",{className:"size-4 bg-orange-500 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"material-symbols-outlined text-white text-[12px]",children:"chevron_right"})})]})]}),t.jsx("div",{className:"relative z-10",children:t.jsx("span",{className:"material-symbols-outlined text-[48px] text-orange-400 drop-shadow-sm",children:"wallet"})}),t.jsx("div",{className:"absolute -right-4 -bottom-4 size-24 bg-orange-200/20 rounded-full blur-2xl"})]})})]}):t.jsx("div",{className:"flex justify-center items-center h-screen",children:t.jsx(r,{size:"w-10 h-10",color:"text-[#00C853]"})})};export{i as default};
