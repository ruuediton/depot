import{r as e,R as a,j as t}from"./react-vendor-0Am1niUb.js";import{s,S as r}from"./index-BonT0QVc.js";import"./supabase-BsxaddrC.js";import"./vendor-DtN75V_I.js";const i=({onNavigate:i,onLogout:l,profile:o,showToast:n})=>{const[c,d]=e.useState(o),[p,x]=e.useState(null),[m,g]=e.useState({balance:o?.balance||0,total_earnings:0,today_earnings:0});e.useEffect(()=>{o&&(d(o),h());const e=e=>{e.preventDefault(),x(e)};return window.addEventListener("beforeinstallprompt",e),()=>{window.removeEventListener("beforeinstallprompt",e)}},[o]);const u=a.useCallback(async()=>{try{if(p){p.prompt();const{outcome:e}=await p.userChoice;"accepted"===e&&(x(null),n?.("Instalação iniciada!","success"))}else{if(window.matchMedia("(display-mode: standalone)").matches||navigator.standalone)return void n?.("O aplicativo já está instalado e em execução.","success");const e=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;n?.(e?"Para instalar no iOS: Toque em 'Compartilhar' e depois em 'Adicionar à Tela de Início'":"Para instalar no Android: Use o menu do navegador e selecione 'Instalar Aplicativo'.","info")}}catch(e){n?.("Não foi possível abrir o instalador. Tente pelo menu do navegador.","error")}},[p,n]),b=a.useMemo(()=>[{label:"Meus dispositivos",icon:"assignment",page:"purchase-history",color:"bg-green-50 text-[#00C853]"},{label:"Extrato de conta",icon:"account_balance",page:"historico-conta",color:"bg-green-50 text-[#00C853]"},{label:"Equipe",icon:"pie_chart",page:"subordinate-list",color:"bg-green-50 text-[#00C853]"},{label:"Resgatar cupons",icon:"auto_awesome",page:"gift-chest",color:"bg-green-50 text-[#00C853]"},{label:"Marketplace",icon:"storefront",page:"investimentos-fundo",color:"bg-green-50 text-[#00C853]"},{label:"Alterar senha login",icon:"lock_open",page:"change-password",color:"bg-green-50 text-[#00C853]"},{label:"Dados bancários",icon:"account_balance",page:"add-bank",color:"bg-green-50 text-[#00C853]"},{label:"Quem Somos",icon:"corporate_fare",page:"about-bp",color:"bg-green-50 text-[#00C853]"},{label:"Termos e regras",icon:"gavel",page:"info",color:"bg-green-50 text-[#00C853]"}],[u]),h=async()=>{if(c?.id)try{const{data:e}=await s.auth.getUser(),a=e.user?.id;if(!a)return;const[t,r,i,l,o,n]=await Promise.all([s.rpc("get_profile_stats"),s.from("retirada_clientes").select("valor_solicitado").eq("user_id",a).in("estado_da_retirada",["concluido","aprovado","sucedido","processado","pagamento_enviado"]),s.from("depositos_clientes").select("valor_deposito").eq("user_id",a).in("estado_de_pagamento",["sucedido","completo","sucesso","concluido"]),s.from("depositos_usdt").select("amount_kz").eq("user_id",a).in("status",["sucedido","completo","sucesso","concluido"]),s.from("bonus_transacoes").select("valor_recebido").eq("user_id",a),s.rpc("get_my_team")]),c=r.data?.reduce((e,a)=>e+Number(a.valor_solicitado||0),0)||0,d=(i.data?.reduce((e,a)=>e+Number(a.valor_deposito||0),0)||0)+(l.data?.reduce((e,a)=>e+Number(a.amount_kz||0),0)||0),p=o.data?.reduce((e,a)=>e+Number(a.valor_recebido||0),0)||0,x=n.data?.length||0;g({balance:t.data?.balance||0,today_earnings:t.data?.renda_diaria||0,total_withdrawals:c,total_recharge:d,total_rewards:p,total_subordinates:x})}catch(e){}};return c?t.jsxs("div",{className:"bg-[#F4F7F6] min-h-screen pb-32 font-display antialiased",children:[t.jsxs("div",{className:"bg-gradient-to-br from-[#0F1111] to-[#1A1C1C] pt-12 pb-24 px-6 rounded-b-[48px] shadow-2xl relative overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-[#00C853]/10 blur-[100px] rounded-full -translate-y-1/2 translate-x-1/2 overflow-hidden pointer-events-none"}),t.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-[#00C853]/5 blur-[80px] rounded-full translate-y-1/2 -translate-x-1/2 overflow-hidden pointer-events-none"}),t.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"size-16 rounded-[24px] p-1 bg-white/10 backdrop-blur-md border border-white/20 overflow-hidden shadow-xl",children:t.jsx("img",{src:c?.avatar_url||"/default_avatar.png",onError:e=>{e.currentTarget.src="/default_avatar.png",e.currentTarget.onerror=null},alt:"Avatar",className:"w-full h-full object-cover rounded-[20px]"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-black text-[18px] text-white tracking-tight",children:"Membro BP"}),t.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[t.jsx("span",{className:"px-2 py-0.5 bg-[#00C853] text-black text-[9px] font-black rounded-md uppercase tracking-widest",children:"VIP"}),t.jsxs("p",{className:"text-[12px] text-white/60 font-medium",children:["ID: ",c.invite_code||"---"]})]})]})]}),t.jsx("button",{onClick:l,className:"size-11 flex items-center justify-center bg-white/10 backdrop-blur-md rounded-2xl text-white border border-white/10 active:scale-90 transition-all hover:bg-white/20",children:t.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"logout"})})]})]}),t.jsx("div",{className:"px-6 -mt-16 relative z-20",children:t.jsxs("div",{className:"bg-white rounded-[32px] p-8 shadow-premium border border-white/50 relative overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5",children:t.jsx("span",{className:"material-symbols-outlined text-[100px] -rotate-12",children:"account_balance_wallet"})}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:"size-1.5 bg-[#00C853] rounded-full animate-pulse"}),t.jsx("span",{className:"text-gray-400 text-[10px] font-black uppercase tracking-[0.2em]",children:"Saldo em Conta"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-baseline gap-2",children:[t.jsx("span",{className:"text-[14px] font-black text-[#00C853] mb-2 uppercase",children:"KZs"}),t.jsx("span",{className:"text-[36px] font-black text-gray-900 tracking-tighter leading-none",children:(m.balance||0).toLocaleString("pt-AO",{minimumFractionDigits:2})})]}),t.jsx("button",{onClick:()=>i("p2p-transfer"),className:"size-14 bg-gray-900 text-white rounded-[24px] flex items-center justify-center shadow-xl active:scale-90 transition-all hover:bg-[#00C853]",children:t.jsx("span",{className:"material-symbols-outlined text-[28px]",children:"payments"})})]})]})]})}),t.jsxs("div",{className:"px-6 mt-8 grid grid-cols-2 gap-4",children:[t.jsxs("button",{onClick:()=>i("deposit"),className:"flex flex-col items-center justify-center gap-1 bg-[#EEFFF5] text-[#00C853] p-4 rounded-[28px] font-black text-[12px] uppercase tracking-widest active:scale-95 transition-all border border-[#00C853]/10",children:[t.jsx("span",{className:"material-symbols-outlined text-2xl mb-1",children:"add_circle"}),"Recarregar"]}),t.jsxs("button",{onClick:()=>i("retirada"),className:"flex flex-col items-center justify-center gap-1 bg-white text-gray-900 shadow-premium p-4 rounded-[28px] font-black text-[12px] uppercase tracking-widest active:scale-95 transition-all border border-gray-100",children:[t.jsx("span",{className:"material-symbols-outlined text-2xl mb-1",children:"arrow_circle_up"}),"Retirar"]})]}),t.jsx("div",{className:"px-6 mt-8",children:t.jsx("div",{className:"bg-white p-2 rounded-[36px] shadow-premium border border-white/50",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{className:"bg-gray-50/50 p-5 rounded-[28px] border border-gray-100",children:[t.jsx("span",{className:"text-gray-400 text-[9px] uppercase font-black tracking-widest",children:"Lucros Hoje"}),t.jsxs("p",{className:"text-[16px] font-black text-[#00C853] mt-1 tracking-tight",children:["+ ",(m.today_earnings||0).toLocaleString("pt-AO",{minimumFractionDigits:2})]})]}),t.jsxs("div",{className:"bg-gray-50/50 p-5 rounded-[28px] border border-gray-100",children:[t.jsx("span",{className:"text-gray-400 text-[9px] uppercase font-black tracking-widest",children:"Total Retirado"}),t.jsxs("p",{className:"text-[16px] font-black text-[#CC0C39] mt-1 tracking-tight",children:["- ",(m.total_withdrawals||0).toLocaleString("pt-AO",{minimumFractionDigits:2})]})]}),t.jsxs("div",{className:"bg-gray-50/50 p-5 rounded-[28px] border border-gray-100",children:[t.jsx("span",{className:"text-gray-400 text-[9px] uppercase font-black tracking-widest",children:"Investimento"}),t.jsx("p",{className:"text-[16px] font-black text-gray-900 mt-1 tracking-tight",children:(m.total_recharge||0).toLocaleString("pt-AO",{minimumFractionDigits:2})})]}),t.jsxs("div",{className:"bg-gray-50/50 p-5 rounded-[28px] border border-gray-100",children:[t.jsx("span",{className:"text-gray-400 text-[9px] uppercase font-black tracking-widest",children:"Recompensas"}),t.jsx("p",{className:"text-[16px] font-black text-[#00C853] mt-1 tracking-tight",children:(m.total_rewards||0).toLocaleString("pt-AO",{minimumFractionDigits:2})})]})]})})}),t.jsx("div",{className:"px-6 mt-8",children:t.jsx("div",{className:"grid grid-cols-4 gap-y-8 gap-x-2",children:b.map(e=>t.jsxs("div",{onClick:()=>e.action?e.action():i(e.page),className:"flex flex-col items-center gap-2 cursor-pointer active:scale-95 transition-all text-center group",children:[t.jsx("div",{className:"size-14 rounded-[20px] flex items-center justify-center bg-white shadow-premium border border-white group-hover:bg-[#00C853] group-hover:text-white transition-all",children:t.jsx("span",{className:"material-symbols-outlined text-[24px]",children:e.icon})}),t.jsx("span",{className:"text-[9px] text-gray-400 leading-tight font-black uppercase tracking-widest px-1",children:e.label})]},e.label))})}),t.jsx("div",{className:"px-6 mt-10",children:t.jsxs("div",{onClick:()=>i("invite-page"),className:"bg-gray-900 rounded-[32px] p-6 flex items-center justify-between cursor-pointer active:scale-[0.98] transition-all relative overflow-hidden shadow-2xl",children:[t.jsxs("div",{className:"relative z-10 w-2/3",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:"size-2 bg-[#00C853] rounded-full"}),t.jsx("span",{className:"text-[10px] text-[#00C853] font-black uppercase tracking-widest",children:"Programa de Afiliados"})]}),t.jsx("h4",{className:"font-black text-[20px] text-white leading-tight tracking-tight",children:"Expanda sua rede e fature mais"})]}),t.jsx("div",{className:"relative z-10",children:t.jsx("div",{className:"size-16 rounded-2xl bg-white/10 backdrop-blur-md flex items-center justify-center border border-white/10",children:t.jsx("span",{className:"material-symbols-outlined text-[32px] text-[#00C853]",children:"groups"})})}),t.jsx("div",{className:"absolute -right-8 -bottom-8 size-32 bg-[#00C853]/10 rounded-full blur-[40px]"})]})})]}):t.jsx("div",{className:"flex justify-center items-center h-screen",children:t.jsx(r,{size:"w-10 h-10",color:"text-[#00C853]"})})};export{i as default};
