import{r as e,j as t}from"./react-vendor-C8-TlGsU.js";import{S as a,s}from"./index-BaS3q1EV.js";import"./pdf-utils-DX6aKe5X.js";import"./vendor-D2WcXlqy.js";import"./supabase-DIRwJvxg.js";const r=({onNavigate:r,showToast:l})=>{const[n,i]=e.useState(!1),[o,c]=e.useState(!1),[x,d]=e.useState(!1),[p,m]=e.useState(""),[u,h]=e.useState(""),[f,b]=e.useState(""),[g,v]=e.useState(!1);return t.jsxs("div",{className:"relative flex min-h-screen w-full flex-col overflow-x-hidden bg-white font-sans text-black antialiased",children:[t.jsx("header",{className:"header-gradient-mixture pb-16 pt-4 px-4",children:t.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[t.jsx("button",{onClick:()=>r("profile"),className:"w-11 h-11 flex items-center justify-center rounded-full bg-white/20 backdrop-blur-md transition-all active:scale-90",children:t.jsx("span",{className:"material-symbols-outlined text-white text-[28px]",children:"arrow_back"})}),t.jsx("h1",{className:"text-xl font-black text-white tracking-tight",children:"Senha de Retirada"}),t.jsx("div",{className:"w-11"})]})}),t.jsx("main",{className:"flex-1 px-5 py-2 flex flex-col",children:t.jsxs("form",{className:"flex flex-col gap-4 mt-6",onSubmit:async e=>{if(e.preventDefault(),p&&u&&f)if(4===u.length&&/^\d+$/.test(u))if(u===f)if(p!==u){v(!0);try{const{data:e,error:t}=await s.rpc("update_withdrawal_password",{p_current_password:p,p_new_password:u});t?l?.("Erro ao atualizar senha: "+t.message,"error"):!1===e?l?.("Senha atual incorreta.","error"):(l?.("Senha de retirada alterada com sucesso!","success"),setTimeout(()=>r("profile"),2e3))}catch(t){l?.("Erro inesperado ao alterar senha.","error")}finally{v(!1)}}else l?.("A nova senha deve ser diferente da atual.","warning");else l?.("As novas senhas não coincidem.","error");else l?.("A nova senha deve ter exatamente 4 números.","warning");else l?.("Por favor, preencha todos os campos.","warning")},children:[t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"lock"}),t.jsx("input",{value:p,onChange:e=>m(e.target.value.replace(/\D/g,"")),maxLength:4,inputMode:"numeric",className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]",placeholder:"Digite a senha atual",type:n?"text":"password"}),t.jsx("button",{type:"button",onClick:()=>i(!n),children:t.jsx("span",{className:"material-symbols-outlined text-gray-400 text-[20px]",children:n?"visibility":"visibility_off"})})]}),t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"lock"}),t.jsx("input",{value:u,onChange:e=>h(e.target.value.replace(/\D/g,"")),maxLength:4,inputMode:"numeric",className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]",placeholder:"Crie uma nova senha (4 dígitos)",type:o?"text":"password"}),t.jsx("button",{type:"button",onClick:()=>c(!o),children:t.jsx("span",{className:"material-symbols-outlined text-gray-400 text-[20px]",children:o?"visibility":"visibility_off"})})]}),t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"lock"}),t.jsx("input",{value:f,onChange:e=>b(e.target.value.replace(/\D/g,"")),maxLength:4,inputMode:"numeric",className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]",placeholder:"Repita a nova senha",type:x?"text":"password"}),t.jsx("button",{type:"button",onClick:()=>d(!x),children:t.jsx("span",{className:"material-symbols-outlined text-gray-400 text-[20px]",children:x?"visibility":"visibility_off"})})]}),t.jsx("div",{className:"flex-1 min-h-[30px]"}),t.jsx("button",{type:"submit",disabled:g,className:"w-full h-[45px] rounded-2xl bg-[#00C853] hover:bg-[#00a844] active:scale-[0.98] transition-all flex items-center justify-center mb-6 shadow-lg shadow-green-200 "+(g?"opacity-50":""),children:g?t.jsx(a,{size:"w-6 h-6",className:"text-black"}):t.jsx("span",{className:"text-white text-[15px] font-bold tracking-wide",children:"Confirmar"})})]})})]})};export{r as default};
