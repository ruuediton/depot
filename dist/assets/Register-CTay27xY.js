import{r as e,j as t}from"./react-vendor-C8-TlGsU.js";import{u as a,s as r}from"./index-BaS3q1EV.js";import{O as s}from"./OptimizedButton-uI_FIe8Q.js";import"./pdf-utils-DX6aKe5X.js";import"./vendor-D2WcXlqy.js";import"./supabase-DIRwJvxg.js";const o=({onNavigate:o,showToast:l})=>{const[n,i]=e.useState(""),[d,c]=e.useState(""),[x,m]=e.useState(""),[p,h]=e.useState(""),[u,f]=e.useState(""),[g,b]=e.useState(""),[v,w]=e.useState(!1),[y,j]=e.useState(!1),[N,C]=e.useState(!1),[S,k]=e.useState(null),[M,P]=e.useState(!1),{withLoading:R}=a(),$=e.useRef(null),z=()=>{const e="0123456789";let t="";for(let a=0;a<4;a++)t+=e.charAt(Math.floor(10*Math.random()));b(t),E(t)},E=e=>{const t=$.current;if(!t)return;const a=t.getContext("2d");if(!a)return;a.clearRect(0,0,t.width,t.height),a.fillStyle="#f3f4f6",a.fillRect(0,0,t.width,t.height);for(let r=0;r<50;r++)a.fillStyle=`rgba(${255*Math.random()},${255*Math.random()},${255*Math.random()},0.5)`,a.beginPath(),a.arc(Math.random()*t.width,Math.random()*t.height,1,0,2*Math.PI),a.fill();for(let r=0;r<5;r++)a.strokeStyle=`rgba(${200*Math.random()},${200*Math.random()},${200*Math.random()},0.3)`,a.beginPath(),a.moveTo(Math.random()*t.width,Math.random()*t.height),a.lineTo(Math.random()*t.width,Math.random()*t.height),a.stroke();a.font="bold 24px monospace",a.textBaseline="middle",a.textAlign="center";for(let r=0;r<e.length;r++)a.save(),a.translate(20+20*r,t.height/2),a.rotate(.4*(Math.random()-.5)),a.fillStyle=`hsl(${360*Math.random()}, 70%, 30%)`,a.fillText(e[r],0,0),a.restore()};e.useEffect(()=>{z();const e=new URLSearchParams(window.location.search).get("ref");e&&h(e);const t=e=>{e.preventDefault(),k(e),P(!0)};return window.addEventListener("beforeinstallprompt",t),()=>{window.removeEventListener("beforeinstallprompt",t)}},[]);return t.jsxs("div",{className:"bg-white min-h-screen font-sans text-black flex flex-col items-center pb-10",children:[t.jsxs("div",{className:"w-full relative mb-8 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-white z-10"}),t.jsx("img",{src:"/register-promo.png",alt:"BP Register Promo",className:"w-full h-[280px] object-cover object-top mask-image-b-fade blur-[1px] opacity-90 scale-105"}),t.jsxs("div",{className:"absolute bottom-4 left-0 w-full text-center z-20 opacity-40",children:[t.jsx("p",{className:"text-gray-600 font-extrabold text-sm tracking-[3px] mb-0.5 drop-shadow-sm uppercase",children:"BP"}),t.jsx("h1",{className:"text-[20px] font-semibold text-gray-500 leading-tight drop-shadow-sm",children:"Registrar"})]}),t.jsxs(s,{onClick:()=>o("tutorials"),className:"absolute top-4 right-4 flex items-center gap-1.5 px-3 py-1.5 bg-white/80 backdrop-blur-sm text-[#00C853] rounded-full hover:bg-white transition-colors active:scale-95 z-30 shadow-sm",type:"button",children:[t.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"help"}),t.jsx("span",{className:"text-[12px] font-bold",children:"Tutoriais"})]})]}),t.jsxs("form",{className:"w-full flex flex-col gap-4 px-6",onSubmit:async e=>{if(e.preventDefault(),v){if(u!==g)return l?.("Código de verificação incorreto.","error"),z(),void f("");if(n.length<9)l?.("Número de telefone inválido.","error");else if(d.length<6)l?.("A senha deve ter pelo menos 6 caracteres.","error");else if(d===x)if(p)try{await R(async()=>{const e=`${n}@bpcommerce.user`,{error:t}=await r.auth.signUp({email:e,password:d,options:{data:{phone:n,referred_by:p}}});if(t){if(t.message.includes("already registered"))throw new Error("Este número já está registrado.");throw t}},"Registro realizado com sucesso!"),setTimeout(()=>o("login"),1500)}catch(t){l?.(t.message||"Erro ao registrar.","error")}else l?.("Por favor insira o código do convite.","warning");else l?.("As senhas não coincidem.","error")}else l?.("Concorde com os termos da isenção de responsabilidade.","warning")},children:[t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"person"}),t.jsx("span",{className:"text-gray-500 font-medium",children:"+244"}),t.jsx("span",{className:"material-symbols-outlined text-gray-400 text-[14px]",children:"arrow_drop_down"}),t.jsx("input",{type:"tel",placeholder:"Por favor insira o número do telefone",className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]",value:n,onChange:e=>i(e.target.value),required:!0})]}),t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"verified_user"}),t.jsx("input",{type:"text",placeholder:"por favor insira o código de verificação",className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]",value:u,onChange:e=>f(e.target.value),required:!0}),t.jsx("div",{className:"h-10 w-24 shrink-0 overflow-hidden rounded-lg cursor-pointer border border-gray-200",onClick:z,title:"Toque para atualizar",children:t.jsx("canvas",{ref:$,width:100,height:40,className:"w-full h-full object-cover"})})]}),t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"lock"}),t.jsx("input",{type:y?"text":"password",placeholder:"Por favor, insira sua senha",className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]",value:d,onChange:e=>c(e.target.value),required:!0}),t.jsx("button",{type:"button",onClick:()=>j(!y),children:t.jsx("span",{className:"material-symbols-outlined text-gray-400 text-[20px]",children:y?"visibility":"visibility_off"})})]}),d.length>=6&&t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors animate-in fade-in slide-in-from-top-2 duration-300",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"lock"}),t.jsx("input",{type:N?"text":"password",placeholder:"Por favor confirme sua senha",className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]",value:x,onChange:e=>m(e.target.value),required:!0}),t.jsx("button",{type:"button",onClick:()=>C(!N),children:t.jsx("span",{className:"material-symbols-outlined text-gray-400 text-[20px]",children:N?"visibility":"visibility_off"})})]}),t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"favorite"}),t.jsx("input",{type:"text",placeholder:"Por favor insira o código do convite",className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]",value:p,onChange:e=>{new URLSearchParams(window.location.search).get("ref")||h(e.target.value)},readOnly:!!new URLSearchParams(window.location.search).get("ref"),required:!0})]}),t.jsxs("div",{className:"flex items-start gap-3 px-1 mt-2",children:[t.jsx("div",{className:"size-5 rounded-full flex shrink-0 items-center justify-center border cursor-pointer transition-colors mt-0.5 "+(v?"bg-[#00C853] border-[#00C853]":"border-gray-300 bg-white"),onClick:()=>w(!v),children:v&&t.jsx("span",{className:"material-symbols-outlined text-white text-[14px]",children:"check"})}),t.jsxs("p",{className:"text-[12px] text-gray-500 leading-tight",children:["Concorde com os ",t.jsx("span",{className:"underline cursor-pointer",children:"termos da isenção de responsabilidade"})]})]}),t.jsx(s,{type:"submit",className:"w-full h-[45px] bg-[#00C853] text-white font-bold rounded-2xl text-[16px] mt-4 hover:bg-[#00a844] active:scale-[0.98] transition-all shadow-lg shadow-green-200",children:"Registrar"}),M&&t.jsxs(s,{type:"button",onClick:async()=>{if(!S)return void l?.("App já está instalado ou não disponível para instalação.","info");S.prompt();const{outcome:e}=await S.userChoice;"accepted"===e?(l?.("App instalado com sucesso!","success"),P(!1)):l?.("Instalação cancelada.","info"),k(null)},className:"w-full h-[45px] bg-gray-100 text-gray-700 font-bold rounded-2xl text-[16px] hover:bg-gray-200 active:scale-[0.98] transition-all shadow-sm flex items-center justify-center gap-2",children:[t.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"download"}),"Baixar app"]}),t.jsx("div",{className:"w-full text-center mt-4",children:t.jsx(s,{type:"button",onClick:()=>o("login"),className:"text-[#fe5722] font-medium text-[14px] hover:underline",children:"Entrar"})})]})]})};export{o as default};
