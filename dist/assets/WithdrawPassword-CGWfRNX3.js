import{r as e,j as t}from"./react-vendor-C8-TlGsU.js";import{u as a,S as s,s as l}from"./index-BaS3q1EV.js";import"./pdf-utils-DX6aKe5X.js";import"./vendor-D2WcXlqy.js";import"./supabase-DIRwJvxg.js";const i=({onNavigate:i,showToast:r})=>{const{withLoading:n}=a(),[o,c]=e.useState(!1),[d,x]=e.useState(!1),[m,p]=e.useState(""),[h,u]=e.useState(""),[f,b]=e.useState(!1);return t.jsxs("div",{className:"relative flex min-h-screen w-full flex-col overflow-x-hidden bg-white font-sans text-black antialiased",children:[t.jsxs("header",{className:"relative header-gradient-mixture pb-16 pt-4 px-4 overflow-hidden",children:[t.jsx("div",{className:"absolute top-[-20%] right-[-10%] w-64 h-64 bg-white/10 rounded-full blur-3xl"}),t.jsx("div",{className:"absolute bottom-[-20%] left-[-10%] w-48 h-48 bg-white/5 rounded-full blur-2xl"}),t.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[t.jsx("button",{onClick:()=>i("profile"),className:"w-11 h-11 flex items-center justify-center rounded-full bg-white/20 backdrop-blur-md transition-all active:scale-90",children:t.jsx("span",{className:"material-symbols-outlined text-white text-[28px]",children:"arrow_back"})}),t.jsx("h1",{className:"text-xl font-black text-white tracking-tight",children:"Senha de Retirada"}),t.jsx("div",{className:"w-11"})]})]}),t.jsx("main",{className:"flex-1 px-5 py-2 flex flex-col",children:t.jsxs("form",{className:"flex flex-col gap-4 mt-6",onSubmit:async e=>{e.preventDefault();const t=m.replace(/\D/g,""),a=h.replace(/\D/g,"");4===t.length?t===a?await n(async()=>{const{data:{user:e}}=await l.auth.getUser();if(!e)throw new Error("Sessão expirada. Acesse novamente.");const{error:a}=await l.rpc("set_withdrawal_password",{p_password:t});if(a)throw a;r?.("Senha de retirada definida com sucesso!","success"),setTimeout(()=>i("profile"),1500)}):r?.("As senhas não coincidem.","error"):r?.("A senha deve conter 4 dígitos numéricos.","warning")},children:[t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"lock"}),t.jsx("input",{value:m,onChange:e=>p(e.target.value.replace(/\D/g,"")),maxLength:4,inputMode:"numeric",className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]",placeholder:"Crie uma nova senha (4 dígitos)",type:o?"text":"password"}),t.jsx("button",{type:"button",onClick:()=>c(!o),children:t.jsx("span",{className:"material-symbols-outlined text-gray-400 text-[20px]",children:o?"visibility":"visibility_off"})})]}),t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"lock"}),t.jsx("input",{value:h,onChange:e=>u(e.target.value.replace(/\D/g,"")),maxLength:4,inputMode:"numeric",className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]",placeholder:"Repita a nova senha",type:d?"text":"password"}),t.jsx("button",{type:"button",onClick:()=>x(!d),children:t.jsx("span",{className:"material-symbols-outlined text-gray-400 text-[20px]",children:d?"visibility":"visibility_off"})})]}),t.jsx("div",{className:"flex-1 min-h-[30px]"}),t.jsx("button",{type:"submit",disabled:f,className:"w-full h-[45px] rounded-2xl bg-[#00C853] hover:bg-[#00a844] active:scale-[0.98] transition-all flex items-center justify-center shadow-lg shadow-green-200 mb-6 "+(f?"opacity-50":""),children:f?t.jsx(s,{size:"w-6 h-6",className:"text-black"}):t.jsx("span",{className:"text-white text-[15px] font-bold tracking-wide",children:"Confirmar"})})]})})]})};export{i as default};
