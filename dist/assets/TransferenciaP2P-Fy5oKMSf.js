import{r as e,j as t}from"./react-vendor-C8-TlGsU.js";import{u as a,S as s,s as r}from"./index-BaS3q1EV.js";import"./pdf-utils-DX6aKe5X.js";import"./vendor-D2WcXlqy.js";import"./supabase-DIRwJvxg.js";const l=({onNavigate:l,showToast:n})=>{const{withLoading:i}=a(),[c,o]=e.useState(""),[d,x]=e.useState(""),[p,m]=e.useState(""),[h,u]=e.useState(!1),[b,f]=e.useState(null),[g,j]=e.useState(!1),y=Number(d),N=y>0?.05*y:0;return t.jsxs("div",{className:"bg-white min-h-screen font-sans text-[#0F1111] selection:bg-amber-100 pb-20 antialiased",children:[t.jsx("header",{className:"header-gradient-mixture pb-16 pt-4 px-4",children:t.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[t.jsx("button",{onClick:()=>l("profile"),className:"w-11 h-11 flex items-center justify-center rounded-full bg-white/20 backdrop-blur-md transition-all active:scale-90",children:t.jsx("span",{className:"material-symbols-outlined text-white text-[28px]",children:"arrow_back"})}),t.jsx("h1",{className:"text-xl font-black text-white tracking-tight",children:"Enviar Saldo"}),t.jsx("button",{onClick:()=>l("historico-p2p"),className:"w-11 h-11 flex items-center justify-center rounded-full bg-white/20 backdrop-blur-md transition-all active:scale-90",children:t.jsx("span",{className:"material-symbols-outlined text-white text-[24px]",children:"history"})})]})}),t.jsxs("main",{className:"flex-1 flex flex-col px-6 pt-8 animate-in fade-in slide-in-from-bottom-8 duration-500 max-w-md mx-auto",children:[t.jsx("div",{className:"relative mb-8",children:t.jsxs("div",{className:"bg-gray-50 border border-gray-100 p-6 rounded-[24px] flex items-center gap-4 relative overflow-hidden",children:[t.jsx("div",{className:"size-14 rounded-2xl bg-white border border-gray-100 flex items-center justify-center shrink-0",children:t.jsx("span",{className:"material-symbols-outlined text-[#e47911] text-3xl",children:"currency_exchange"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-[#565959] text-[10px] font-bold uppercase tracking-widest mb-1",children:"Envio P2P"}),t.jsx("p",{className:"text-[13px] font-bold text-[#0F1111] leading-tight",children:"Envie saldo instantaneamente para qualquer conta BP."})]})]})}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("label",{className:"block text-[11px] font-bold text-gray-500 ml-1 uppercase tracking-wider",children:"Telefone do Destinatário"}),g&&t.jsx("span",{className:"text-[10px] text-[#00C853] animate-pulse",children:"Verificando..."}),b&&!g&&t.jsx("span",{className:"text-[10px] text-green-600 font-bold truncate max-w-[150px]",children:b})]}),t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border transition-colors "+(b?"border-green-500":"border-transparent focus-within:border-[#00C853]"),children:[t.jsx("span",{className:"material-symbols-outlined text-[24px] "+(b?"text-green-500":"text-[#00C853]"),children:b?"check_circle":"person_search"}),t.jsx("input",{type:"tel",placeholder:"Nº do destinatário",value:c,onChange:async e=>{const t=e.target.value;if(o(t),f(null),t.length>=9){j(!0);try{const{data:e,error:a}=await r.from("profiles").select("full_name").eq("phone",t).single();e&&f(e.full_name)}catch(a){}finally{j(!1)}}},className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-[11px] font-bold text-gray-500 ml-1 uppercase tracking-wider",children:"Valor a Enviar"}),t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"payments"}),t.jsx("input",{type:"number",placeholder:"0.00",value:d,onChange:e=>x(e.target.value),className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[14px]"}),t.jsx("span",{className:"text-[14px] font-bold text-gray-400",children:"Kz"})]})]}),t.jsxs("div",{className:"bg-gray-50/50 border border-gray-100 rounded-2xl p-5 space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center text-[12px]",children:[t.jsx("span",{className:"text-gray-500 font-bold uppercase tracking-tighter",children:"Subtotal (Líquido)"}),t.jsxs("span",{className:"text-[#0F1111] font-black",children:["Kz ",(y-N).toLocaleString("pt-AO")]})]}),t.jsxs("div",{className:"flex justify-between items-center text-[12px]",children:[t.jsx("span",{className:"text-gray-500 font-bold uppercase tracking-tighter",children:"Taxa Operacional (5%)"}),t.jsxs("span",{className:"text-red-600 font-black",children:["+ Kz ",N.toLocaleString("pt-AO")]})]}),t.jsx("hr",{className:"border-gray-200"}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-[#565959] font-black uppercase text-[10px] tracking-[0.2em]",children:"Total Bruto (Debitado)"}),t.jsxs("span",{className:"text-2xl font-black text-[#0F1111] tracking-tighter",children:["Kz ",y.toLocaleString("pt-AO")]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-[11px] font-bold text-gray-500 ml-1 uppercase tracking-wider",children:"Senha de Retirada"}),t.jsxs("div",{className:"bg-gray-50 rounded-xl h-[50px] flex items-center px-4 gap-3 relative border border-transparent focus-within:border-[#00C853] transition-colors",children:[t.jsx("span",{className:"material-symbols-outlined text-[#00C853] text-[24px]",children:"lock"}),t.jsx("input",{type:"password",placeholder:"••••",value:p,onChange:e=>m(e.target.value),className:"bg-transparent flex-1 h-full outline-none text-[#111] font-medium placeholder:text-gray-400 text-[20px] tracking-[0.4em]"})]})]}),t.jsx("button",{onClick:async()=>{if(c&&d&&p)if(y<1e3)n?.("Mínimo de envio é 1.000 Kz.","warning");else if(y>1e4)n?.("Máximo de envio é 10.000 Kz.","warning");else{u(!0);try{await i(async()=>{const{data:e,error:t}=await r.rpc("transfer_p2p",{p_receiver_phone:c,p_amount:y,p_password:p});if(t)throw t;if(!e||!e.success)throw new Error(e?.message||"Erro no envio.");n?.(e.message||"Envio bem-sucedido","success"),l("historico-p2p")})}catch(e){n?.(e.message||"Erro ao processar transferência.","error")}finally{u(!1)}}else n?.("Preencha todos os campos.","warning")},disabled:h||!d||!c||!p,className:"w-full h-[45px] bg-[#00C853] text-white border border-[#00C853] font-bold text-[15px] uppercase tracking-widest rounded-xl active:scale-[0.98] transition-all disabled:opacity-50 disabled:grayscale mt-4 hover:bg-[#111] hover:text-[#00C853]",children:h?t.jsx(s,{size:"w-6 h-6",color:"text-[#0F1111]"}):"Confirmar Envio"}),t.jsx("p",{className:"text-center text-[11px] text-gray-400 font-medium px-4 leading-relaxed italic",children:"O envio de saldo entre contas BP é instantâneo e seguro. Verifique os dados antes de confirmar."})]})]})]})};export{l as default};
